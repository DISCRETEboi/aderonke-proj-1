---
title: "Data Analysis using R"
author: '******'
date: "`r Sys.Date()`"
output: pdf_document
---

Loading required libraries

```{r}
library(dplyr)
library(stringr)
library(ggplot2)
```

## Task 1

Reading the dataset into R

```{r}
cdrc_data <- read.csv("hh_churn_lsoa11_2023.csv")
str(cdrc_data)
```

## Task 2

Examining the LSOA code W01000092 Menai (Bangor), and identifying the index which W01000092 is greater than 0.5 and less than 0.8.

```{r}
cdrc_data_menai <- filter(cdrc_data, area == "W01000092")
cdrc_data_menai_W01000092 <- unlist(cdrc_data_menai[1, -1])

cdrc_data_menai_sub <- cdrc_data_menai_W01000092[cdrc_data_menai_W01000092 > 0.5 & cdrc_data_menai_W01000092 < 0.8]
print(cdrc_data_menai_sub)
print(names(cdrc_data_menai_sub))
```

## Task 3

Appending additional columns to the data

```{r}
cdrc_data$ARMI <- round(rowMeans(cdrc_data[, -c(1, 28)]), 3)
cdrc_data$ARMIctgrs <- cut(cdrc_data$ARMI, breaks = c(0, 0.2, 0.5, 1), labels = c("Low", "Medium", "High"))
str(cdrc_data)
```

## Task 4

xxx

```{r}
avg_armi <- round(colMeans(cdrc_data[, 2:27]), 3)
years <- as.numeric(str_replace(names(avg_armi), "chn", ""))
ts_df <- data.frame(year = years, avg_rmi = avg_armi)

ggplot(ts_df, aes(x = year, y = avg_rmi)) +
  geom_line(color = "steelblue", linewidth = 1.2) +
  labs(x = "Year",
       y = "Average residential mobility index",
       title = "Trend of residential mobility index over time across regions") +
  theme_bw()
```

The chart in Figure is a time series plot showing the change in residential mobility index (averaged across all the regions) over time from 1997 to 2022. The plot clearly shows a sharp downward trend in the residential mobility index over time. 


```{r}
ggplot(cdrc_data, aes(x = chn1997, y = chn2022, color = ARMIctgrs)) +
  geom_point() +
  labs(x = "Residential mobility index in 1997",
       y = "Residential mobility index in 2022",
       color = "RMI level",
       title = "Correlation plot for the residential mobility index - year 2022 against 1997") +
  theme_bw()
```

























